{"pages":[{"title":"About","text":"","link":"/about/index.html"}],"posts":[{"title":"Hello World","text":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new \"My New Post\" More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment","link":"/2019/03/hello-world/"},{"title":"Ubuntu 内核升级","text":"Linux 内核大概几天就会有一个小版本更新，几个月就会有一次主要版本的更新，例如： 2018-10-22 v4.19 2018-12-24 v4.20 2019-03-04 v5.0 2019-03-10 v5.0.1 2019-03-14 v5.0.2 2019-03-19 v5.0.3 为了使用一些新的特性，或者为了提升性能和安全性，或者只是为了修复某些问题，需要对内核进行单独升级。 The Linux Kernel ArchivesUbuntu Kernel Mainline 升级内核正常情况下不会出现问题，但不排除可能会出现问题，请合理评估风险。 查看当前内核版本可以通过 uname 查看当前内核版本， 12$ uname -srLinux 4.4.0-92-generic 或者输入 uname -a 查看完整信息。 Ubuntu 内核升级最好是升级到长期支持版（longterm）本或者稳定版（stable），可以在 The Linux Kernel Archives查看当前的版本，这里以 longterm: 4.19.36 为例。 之后在 Ubuntu Kernel Mainline 找到对应的版本号，https://kernel.ubuntu.com/~kernel-ppa/mainline/v4.19.36/ 。 在对应的架构Build for xxx succeeded，下载不包含 lowlatency 的所有deb文件。例如在 x86_64 下，总共需要下载4个文件。 1234linux-headers-4.19.36-041936_4.19.36-041936.201904200430_all.deblinux-headers-4.19.36-041936-generic_4.19.36-041936.201904200430_amd64.deblinux-image-unsigned-4.19.36-041936-generic_4.19.36-041936.201904200430_amd64.deblinux-modules-4.19.36-041936-generic_4.19.36-041936.201904200430_amd64.deb 安装 1sudo dpkg -i linux-*.deb 重启 1sudo reboot 确认升级成功 12$ uname -srLinux 4.19.36-041936-generic 这里看到内核版本已经升级成功了，其他版本或者架构操作也类似。 删除旧的内核版本如果确实要移除旧的内核版本，可以通过该命令查看已经安装的内核版本， 1dpkg --get-selections | grep linux 然后直接使用 apt-get purge 删除旧版本的包（有明确的版本号）。 总结还有一些其他方法，例如直接用 apt-get 升级，还有一些工具，具体可以参考 How to update kernel to the latest mainline version without any Distro-upgrade?","link":"/2019/04/kernel-update/"},{"title":"用 Python 设计 Logo","text":"用 Python 设计一个简单的 logo 。 预览logo.svg favicon.svg 代码代码只依赖 matplotlib。 12345678910111213141516171819202122232425262728293031import matplotlib.pyplot as pltlines = [[[1, 4], [5, 8.08]], [[1, 4], [5, 1.92]], [[5, 9], [2.96, 7.04]], [[5, 6.5], [7.04, 5.5]], [[8, 9], [4, 2.96]]]color = '#00a4ef'linewidth = 28# favicon.svgplt.figure(figsize=(4, 4))plt.axis('off')plt.axis([0, 10, 0, 10])for l in lines: plt.plot(l[0], l[1], color, linewidth=linewidth)plt.savefig('favicon.svg')# logo.svgplt.figure(figsize=(10, 4))plt.axis('off')plt.axis([0, 25, 0, 10])for l in lines: plt.plot(l[0], l[1], color, linewidth=linewidth)plt.text(11, 2, 'Lxy', fontsize=180)plt.savefig('logo.svg') SVG 压缩压缩SVG可以减少图片大小，尝试了几个在线压缩svg的网站，效果都不太理想，主要是形状处理不准确，跟原图显示不一样。后来试了 https://vecta.io/nano 效果非常好而且压缩率也不错，上述两张图片压缩率超过 60% 。 替换本博客使用的是 icarus 主题，在 themes/icarus/source/images 目录下替换 favicon.svg 和 logo.svg 即可，其他主题操作也类似。","link":"/2019/03/python-logo/"},{"title":"Icarus 主题自定义","text":"本博客所选取的主题是 Icarus ，并做了一些个性化的修改，很多修改都可以直观的看到。详细的差异可以查看 diff，这里记录一些主要的改动。 注: 可以通过变量 page.layout 来判断当前页面类型，'post' 表示当前是文章页面，具体可参考 hexo 文档。 布局文章页面两栏布局主题默认是三栏布局，并且显示了很多的 widget ，但在阅读文章时显得有些拥挤。因此在文章页面，修改为两栏布局，并显示特定的 widget。 diff:includes/helpers/layout.js12345678910 const widgets = hexo.extend.helper.get('get_config').bind(this)('widgets');- return widgets.filter(widget =&gt; widget.hasOwnProperty('position') &amp;&amp; widget.position === position);+ if (this.page.layout !== 'post') {+ return widgets.filter(widget =&gt; widget.hasOwnProperty('position') &amp;&amp; widget.position === position);+ }+ if (position === 'left') {+ return widgets.filter(widget =&gt; widget.hasOwnProperty('position') &amp;&amp; (widget.type === 'toc' || widget.type === 'profile'));+ } else {+ return []+ } 可以参考上述代码，即可实现不同页面不同 widget。 但两栏整体宽度跟三栏不同。因此强制指定为三栏布局，并且修改相应的宽度，这样所有的页面侧边栏宽度保持一致。 diff:layout/common/widget.ejs123456 &lt;% function side_column_class() { switch (column_count()) { case 2:- return 'is-4-tablet is-4-desktop is-4-widescreen';+ return 'is-4-tablet is-4-desktop is-3-widescreen'; case 3: diff:layout/layout.ejs12345678910-&lt;body class=\"is-&lt;%= column_count() %&gt;-column\"&gt;+&lt;body class=\"is-3-column\"&gt; &lt;%- partial('common/navbar', { page }) %&gt; &lt;% function main_column_class() { switch (column_count()) { case 1: return 'is-12'; case 2:- return 'is-8-tablet is-8-desktop is-8-widescreen';+ return 'is-8-tablet is-8-desktop is-9-widescreen'; 并修改在不同屏幕小大下的宽度 diff:source/css/style.styl12345678910111213 .is-2-column .container max-width: screen-desktop - 2 * gap width: screen-desktop - 2 * gap+ .is-3-column .container+ max-width: screen-widescreen - gap+ width: screen-widescreen - gap @media screen and (min-width: screen-fullhd)+ .is-3-column .container+ max-width: screen-fullhd - 2 * gap+ width: screen-fullhd - 2 * gap .is-2-column .container max-width: screen-widescreen - 2 * gap width: screen-widescreen - 2 * gap 优化文章标题布局标题移动到文章信息上方，增加更新时间，并增加了icon。 diff:layout/common/article.ejs1234567891011121314151617 &lt;div class=\"card-content article &lt;%= post.hasOwnProperty('direction') ? post.direction : '' %&gt;\"&gt;+ &lt;h1 class=\"title is-size-3 is-size-4-mobile has-text-weight-normal\"&gt;+ &lt;% if (index) { %&gt;+ &lt;a class=\"has-link-black-ter\" href=\"&lt;%- url_for(post.link ? post.link : post.path) %&gt;\"&gt;&lt;i class=\"fas fa-angle-double-right\"&gt;&lt;/i&gt;&lt;%= post.title %&gt;&lt;/a&gt;+ &lt;% } else { %&gt;+ &lt;i class=\"fas fa-angle-double-right\"&gt;&lt;/i&gt;&lt;%= post.title %&gt;+ &lt;% } %&gt;+ &lt;/h1&gt; &lt;% if (post.layout != 'page') { %&gt; &lt;div class=\"level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto\"&gt; &lt;div class=\"level-left\"&gt;- &lt;time class=\"level-item has-text-grey\" datetime=\"&lt;%= date_xml(post.date) %&gt;\"&gt;&lt;%= date(post.date) %&gt;&lt;/time&gt;+ &lt;time class=\"level-item has-text-grey\" datetime=\"&lt;%= date_xml(post.date) %&gt;\"&gt;&lt;i class=\"far fa-calendar-alt\"&gt;&amp;nbsp;&lt;/i&gt;&lt;%= date(post.date) %&gt;&lt;/time&gt;+ &lt;% if (post.updated &amp;&amp; post.updated &gt; post.date) { %&gt;+ &lt;time class=\"level-item has-text-grey is-hidden-mobile\" datetime=\"&lt;%= date_xml(post.updated) %&gt;\"&gt;&lt;i class=\"far fa-calendar-check\"&gt;&amp;nbsp;&lt;/i&gt;&lt;%= date(post.updated) %&gt;&lt;/time&gt;+ &lt;% } %&gt; &lt;% if (post.categories &amp;&amp; post.categories.length) { %&gt; 其中创建时间使用日期。 diff:source/js/main.js12345- if (typeof(moment) === 'function') {- $('.article-meta time').each(function () {- $(this).text(moment($(this).attr('datetime')).fromNow());- });- } 优化文章结尾布局在文章结尾增加一个 hr，并修改 tags 展示。在预览时也显示 tags，并且将 Read More 按钮放置在右边。 diff:layout/common/article.ejs123456789101112131415161718192021222324252627282930313233343536 &lt;% if (!index &amp;&amp; post.tags &amp;&amp; post.tags.length) { %&gt;+ &lt;hr style=\"height:1px;margin:1rem 0\"/&gt; &lt;div class=\"level is-size-7 is-uppercase\"&gt; &lt;div class=\"level-start\"&gt; &lt;div class=\"level-item\"&gt;- &lt;span class=\"is-size-6 has-text-grey has-mr-7\"&gt;#&lt;/span&gt;+ &lt;i class=\"fas fa-tags has-text-grey\"&gt;&lt;/i&gt;&amp;nbsp; &lt;%- list_tags(post.tags, { class: 'has-link-grey ', show_count: false,- style: 'link'+ style: 'link',+ separator: ',&amp;nbsp;' }) %&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;% } %&gt; &lt;% if (index &amp;&amp; post.excerpt) { %&gt;- &lt;div class=\"level is-mobile\"&gt;+ &lt;hr style=\"height:1px;margin:1rem 0\"/&gt;+ &lt;div class=\"level is-mobile is-flex\"&gt;+ &lt;div class=\"level-start\"&gt;+ &lt;% if (post.tags &amp;&amp; post.tags.length) { %&gt;+ &lt;div class=\"level-item is-size-7 is-uppercase\"&gt;+ &lt;i class=\"fas fa-tags has-text-grey\"&gt;&lt;/i&gt;&amp;nbsp;+ &lt;%- list_tags(post.tags, {+ class: 'has-link-grey ',+ show_count: false,+ style: 'link',+ separator: ',&amp;nbsp;'+ }) %&gt;+ &lt;/div&gt;+ &lt;% } %&gt;+ &lt;/div&gt; &lt;div class=\"level-start\"&gt; 优化个人信息布局减少头像大小，头像下方计数的地方增加链接，follow前增加icon。 diff:layout/widget/profile.ejs1234567- &lt;nav class=\"level is-mobile\"&gt;+ &lt;nav class=\"level menu-list is-mobile\" style=\"margin-bottom:1rem\"&gt; &lt;div class=\"level-item has-text-centered is-marginless\"&gt;- &lt;div&gt;+ &lt;a href=\"&lt;%- url_for('/archives/') %&gt;\"&gt; &lt;p class=\"heading\"&gt;...... 优化移动端显示在移动端，隐藏 archive 和 tagcloud。 diff:layout/widget/archive.ejs12-&lt;div class=\"card widget\"&gt;+&lt;div class=\"card widget is-hidden-mobile\"&gt; diff:layout/widget/tagcloud.ejs12-&lt;div class=\"card widget\"&gt;+&lt;div class=\"card widget is-hidden-mobile\"&gt; 目录粘性布局增加 column-left is-sticky 类。 diff:layout/widget/toc.ejs12-&lt;div class=\"card widget\" id=\"toc\"&gt;+&lt;div class=\"card widget column-left is-sticky\" id=\"toc\"&gt; 功能增加版权说明diff:layout/common/article.ejs1234567891011121314 &lt;div class=\"content\"&gt; &lt;%- index &amp;&amp; post.excerpt ? post.excerpt : post.content %&gt; &lt;/div&gt;+ &lt;% if (!index &amp;&amp; post.layout === 'post' &amp;&amp; post.copyright !== false) { %&gt;+ &lt;ul class=\"post-copyright\"&gt;+ &lt;li&gt;&lt;strong&gt;本文标题：&lt;/strong&gt;&lt;a href=\"&lt;%= post.permalink %&gt;\"&gt;&lt;%= page.title %&gt;&lt;/a&gt;&lt;/li&gt;+ &lt;li&gt;&lt;strong&gt;本文作者：&lt;/strong&gt;&lt;a href=\"&lt;%= theme.url %&gt;\"&gt;&lt;%= theme.author %&gt;&lt;/a&gt;&lt;/li&gt;+ &lt;li&gt;&lt;strong&gt;本文链接：&lt;/strong&gt;&lt;a href=\"&lt;%= post.permalink %&gt;\"&gt;&lt;%= post.permalink %&gt;&lt;/a&gt;&lt;/li&gt;+ &lt;li&gt;&lt;strong&gt;发布时间：&lt;/strong&gt;&lt;%= post.date.format(\"YYYY-MM-DD\") %&gt;&lt;/li&gt;+ &lt;li&gt;&lt;strong&gt;版权声明：&lt;/strong&gt;本博客所有文章除特别声明外，均采用 &lt;a href=\"https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh\" rel=\"external nofollow\" target=\"_blank\"&gt;CC BY-NC-SA 4.0&lt;/a&gt; 许可协议。转载请注明出处！+ &lt;/li&gt;+ &lt;/ul&gt;+ &lt;% } %&gt; &lt;% if (!index &amp;&amp; post.tags &amp;&amp; post.tags.length) { %&gt; 并增加样式 diff:source/css/style.styl12345678+.post-copyright+ font-size: 1rem+ letter-spacing: 0.02rem+ word-break: break-all+ margin: 2.5rem 0 0+ padding: 1rem 1rem+ border-left: 3px solid #FF1700+ background-color: #F9F9F9 增加标题自动计数diff:source/css/style.styl1234567+.article {counter-reset:section}+.article h2{counter-reset:sub-section}+.article h3{counter-reset:composite}+.article h4{counter-reset:detail}+.article h2:before{content:counter(section) \" \";counter-increment:section}+.article h3:before{content:counter(section) \".\" counter(sub-section) \" \";counter-increment:sub-section}+.article h4:before{content:counter(section) \".\" counter(sub-section) \".\" counter(composite) \" \";counter-increment:composite} 默认显示目录正常开启目录需要在 meta 信息中加入 toc: true 开启，但绝大部分文章都是有目录的，因此修改为默认开启。因为有多个地方引用了 get_config('toc') 并且需要判断当前页面，改起来稍微麻烦一些，因此直接修改了 get_config 方法。 diff:includes/helpers/config.js1234567 return defaultValue; } else { const property = readProperty(specs, configName);- return property === null ? null : property[descriptors.defaultValue];+ const result = property === null ? null : property[descriptors.defaultValue];+ return (configName === 'toc' &amp;&amp; this.page.layout === 'post' &amp;&amp; result === null) ? true : result; } 页面footer显示一组icon默认情况下一个icon对应一个链接，但例如 CC BY-NC-SA 4.0 需要四个图标一组。因此修改代码，使得配置 link.icon 可以是一个数组，效果可以参考页面底部。 diff:layout/common/footer.ejs1234 &lt;% } else { %&gt;- &lt;i class=\"&lt;%= link.icon %&gt;\"&gt;&lt;/i&gt;+ &lt;% for (let icon of (Array.isArray(link.icon) ? link.icon : [link.icon])) { %&gt;&lt;i class=\"&lt;%= icon %&gt;\"&gt;&lt;/i&gt;&amp;nbsp;&lt;% } %&gt; &lt;% } %&gt; diff:includes/specs/icon_link.spec.js12345 icon: { [required]: true,- [type]: 'string',+ [type]: ['string', 'array'], [doc]: 'Link icon class names' _config.yml 中配置如下 _config.yml123456789footer: links: CC BY-NC-SA 4.0: icon: - fab fa-creative-commons - fab fa-creative-commons-by - fab fa-creative-commons-nc - fab fa-creative-commons-sa url: 'https://creativecommons.org/licenses/by-nc-sa/4.0/' 可以配置文章开头是否显示图片Icarus 支持文章设置一个图片，在文章开头、最近的文章、时间线等地方显示。但有些图放大之后会显得很不协调，因此修改以支持自定义是否显示。修改 has_thumbnail 方法，增加参数 isArticle 参数，默认 false，并在文章页面修改调用参数。 diff:includes/helpers/page.js1234567891011- hexo.extend.helper.register('has_thumbnail', function (post) {+ hexo.extend.helper.register('has_thumbnail', function (post, isArticle = false) { const getConfig = hexo.extend.helper.get('get_config').bind(this); const allowThumbnail = getConfig('article.thumbnail', true); if (!allowThumbnail) { return false; }+ if (isArticle &amp;&amp; post['article-thumbnail'] === false){+ return false;+ } return post.hasOwnProperty('thumbnail') &amp;&amp; post.thumbnail; diff:layout/common/article.ejs1234 &lt;div class=\"card\"&gt;- &lt;% if (has_thumbnail(post)) { %&gt;+ &lt;% if (has_thumbnail(post, true)) { %&gt; &lt;div class=\"card-image\"&gt; 这样修改之后，如果文章 meta 信息中包含 article-thumbnail: false，就可以取消图片的显示。 样式修改 logo 和 favicon用 Python 设计 Logo，并微调样式。 按钮背景颜色增加渐变diff:source/css/style.styl123456 .menu-list li ul margin-right: 0+ .menu-list a+ transition: background-color 0.3s ease-in-out .menu-list a.level display: flex card 增加浮动效果:hover 时增大阴影，并增加动画属性 ease-in-out。 diff:source/css/style.styl12345 .card border-radius: 4px box-shadow: 0 4px 10px rgba(0,0,0,0.05), 0 0 1px rgba(0,0,0,0.1)+ &amp;:hover+ box-shadow: 0 6px 15px rgba(0,0,0,0.15), 0 0 1px rgba(0,0,0,0.1) diff:source/js/animation.js123 element.style.transform = '';- element.style.transition = 'opacity 0.3s ease-out, transform 0.3s ease-out';+ element.style.transition = 'opacity 0.3s ease-out, transform 0.3s ease-out, box-shadow 0.3s ease-in-out'; 更新2020-02-16 合并了 2.7.0 版本，冲突不算太多，有两个点需要注意一下。 icarus 的配置里面，plugins.clipboard 需要移除，相关的配置移动到 article.highlight.clipboard。 _config.yml12345678910article: # Code highlight settings highlight: # Code highlight themes # https://github.com/highlightjs/highlight.js/tree/master/src/styles theme: github-gist # Show code copying button clipboard: true # Default folding status of the code blocks. Can be \"\", \"folded\", \"unfolded\" fold: unfolded 如果之前 links widget 没有配置链接，可能会遇到编译错误，需要增加一下判断。 diff:layout/widget/links.locals.js12345 const links = get_config_from_obj(locals.widget, 'links');- if (Object.keys(links).length == 0) {+ if (!links || Object.keys(links).length == 0) { return null; } 总结这里只列举了部分改动，详细的差异可以查看 diff。 本文会持续更新，保持跟最新的博客效果一致，希望能给你自定义主题一些帮助。 如果有其他想法或者意见，可以在下方留言。 😊","link":"/2019/03/customize-icarus/"}],"tags":[{"name":"hexo","slug":"hexo","link":"/tags/hexo/"},{"name":"icarus","slug":"icarus","link":"/tags/icarus/"},{"name":"linux","slug":"linux","link":"/tags/linux/"},{"name":"ubuntu","slug":"ubuntu","link":"/tags/ubuntu/"},{"name":"python","slug":"python","link":"/tags/python/"},{"name":"matplotlib","slug":"matplotlib","link":"/tags/matplotlib/"}],"categories":[{"name":"hexo","slug":"hexo","link":"/categories/hexo/"},{"name":"icarus","slug":"hexo/icarus","link":"/categories/hexo/icarus/"},{"name":"linux","slug":"linux","link":"/categories/linux/"},{"name":"python","slug":"python","link":"/categories/python/"},{"name":"ubuntu","slug":"linux/ubuntu","link":"/categories/linux/ubuntu/"},{"name":"matplotlib","slug":"python/matplotlib","link":"/categories/python/matplotlib/"}]}